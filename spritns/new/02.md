# üöÄ Sprint 2 ‚Äî User Authentication & Frontend Integration

**Goal**: Implement Google OAuth login, secure backend routes, and connect with the frontend.

## üß± Backend: Authentication & User Session

- [ ] Create /auth/google route
  - [ ] Redirect to Google OAuth consent page using googleapis library
  - [ ] Use credentials from .env:

        ```sh
        GOOGLE_CLIENT_ID=
        GOOGLE_CLIENT_SECRET=
        GOOGLE_REDIRECT_URI=http://localhost:4000/auth/google/callback
        ```
- [ ] Create /auth/google/callback route
  - [ ] Handle OAuth callback
  - [ ] Exchange code for tokens
  - [ ] Upsert user into User table via Prisma
  - [ ] Save tokens into Token table
  - [ ] Return JWT or session response to frontend
- [ ] Add JWT authentication
  - [ ] Install jsonwebtoken
  - [ ] Create helper functions (signToken, verifyToken)
  - [ ] Create middleware requireAuth to protect endpoints
- [ ] Protect key routes
  - [ ] /tasks
  - [ ] /instructions
  - [ ] /user/me

---

## üß† Backend: Demo Data & API

- [ ] GET /user/me ‚Üí return logged-in user info
- [ ] GET /tasks ‚Üí return user‚Äôs tasks
- [ ] GET /instructions ‚Üí return ongoing rules
- [ ] Use Prisma relations for efficient joins

---

## üñ•Ô∏è Frontend Integration

- [ ] Add .env.local with NEXT_PUBLIC_API_URL=http://localhost:4000
- [ ] Create ‚ÄúSign in with Google‚Äù button
  - [ ] Redirect to backend /auth/google
- [ ] Handle redirect from /auth/google/callback
  - [ ] Parse token or session from backend
  - [ ] Store JWT in localStorage or cookie
- [ ] Fetch /user/me to display demo user info

## ‚öôÔ∏è Environment & Deployment

- [ ] Add GOOGLE_CLIENT_ID, GOOGLE_CLIENT_SECRET to .env and Docker
- [ ] Verify backend can reach Google APIs inside Docker
- [ ] Update docker-compose.yml with OAuth callback URL

## üß© Optional Enhancements

- [ ] Implement refresh token rotation
- [ ] Add /sync/google/contacts endpoint
- [ ] Add /sync/google/calendar endpoint
